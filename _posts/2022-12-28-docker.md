---
layout: single
title:  "[JAVA] docker"
categories: JAVA  #카테고리
tag: [docker] #태그
toc: true  #오른쪽에 있는 목차
toc_sticky: true #목차 고정
author_profile: true  #왼쪽에 자기 소개란 프로필을 이 페이지에 들어갈때 끄는 기능
sidebar:
    nav: "docs" #navigation.yml에 있는 docs를 뜻한다.
search: true  #이 페이지는 검색에 나옴.
---

이번 글은 도커에 대해서 공부한 내용을 정리한 것이다.

## 도커 사용 이유

### 도커란?

> 도커 : 데이터 또는 프로그램을 격리시키는 기능을 제공하는 소프트웨어이다

이 기능은 주로 서버에 사용된다.

예를 들어 서버에서는 아파치, MySQL 등 여러 프로그램(소프트웨어)이 함께 동작한다. 

도커는 위와 같이 다양한 프로그램과 데이터를 각각 독립된 환경에 격리하는 기능을 제공한다.

### 데이터나 프로그램을 독립된 환경에 격리해야 하는 이유

> 대부분의 프로그램은 프로그램 단독으로 동작하지 않고, 어떤 실행 환경이나 라이브러리, 다른 프로그램을 이용해 동작한다.

이 때문에 프로그램 하나를 업데이트하면 다른 프로그램에도 영향을 미치게 된다.

설계할 때는 문제가 없었던 프로그램끼리도 실제로 설치해보면 오류를 일으키는 경우도 있다. 이러한 문제의 원인은 대부분 프로그램 간 공유에 있다.

### 프로그램 격리

일반적인 환경에서는 한 대의 서버 혹은 컴퓨터에서 한 벌만 설치할 수 있는 소프트웨어가 대부분이다.

> 도커를 사용하게 된다면 같은 소프트웨어를 여러 벌 설치가 가능하다.(각 컨테이너에 하나씩 넣으면 된다.)

```plaintext
즉, 도커를 사용하면
1. 프로그램을 완전히 격리시켜 독립적인 환경에서 안전하게 운영할 수 있다.
( 무엇을 업데이트하더라도 서로 영향을 미치지 않는다.)
2. 컨테이너 기술을 활용하면 여러 개의 웹 서버를 올릴 수 있다.
(물리 서버의 수를 줄일 수 있다.)
3. 운영체제가 달라도 컨테이너를 옮길 수 있다.
(물리적 환경의 차이, 서버 구성의 차이를 무시)
```

## 도커의 동작 원리

> 한마디로, **운영체제 위에 도커 엔진이 동작하고 그 위에서 컨테이너가 동작**한다.

프로그램이나 데이터는 컨테이너 안에 위치한다.

### 리눅스 운영체제가 동작하는 것을 전제로, 리눅스 운영체제에서만 동작한다.

그러면 윈도우나 macOS는 도커를 사용하지 못할까?

아니다. 사용할 수 있다.

(1) VMware와 같은 가상 환경 위에 리눅스 운영체제를 설치하고 도커를 실행하거나 

(2) 윈도우용(WSL2) 또는 macOS용 도커 데스크톱처럼 리눅스 운영체제를 포함하는 패키지를 설치해서 사용하면 된다.

## 도커 허브와 이미지

### 이미지
- 이미지는 컨테이너를 만드는데 사용하는 컨테이너의 설계도 역할을 한다. 그래서 이미지로 동일한 컨테이너를 여러 개 만들 수 있다. 
- 컨테이너로도 이미지를 만들 수 있다.
- 그래서 도커 엔진간 컨테이너의 이동이 가능하다.

그러면 이미지는 어디서 구해야 할까?

이미지는 주로 '도커 허브'에서 구하게 된다. 
- 도커허브 : 공식적으로 운영되는 도커 레지스트리(이미지를 배포하는 서비스)의 이름이다.
- [도커 허브][https://hub.docker.com]
- 스마트폰의 구글 플레이 스토어와도 같은 존재로, 공개된 컨테이너 이미지가 모여 있는 곳이다.


## 컨테이너의 생애주기와 데이터 저장

### 컨테이너는 '쓰고 버리는' 일회용품이다.
컨테이너를 업데이트하면서 계속 사용하기 보다는 업데이트된 소프트웨어가 들어있는 새로운 컨테이너를 사용하는 것이 좋다.

**즉, 새로운 버전이 나오면 새로운 컨테이너로 갈아타는 것이다.**

```plaintext
컨테이너의 생애주기 : 컨테이너를 만들고 > 실행하고 > 종료하고 > 폐기하는 과정
```

### 데이터 저장
컨테이너를 폐기하면 컨테이너 안에 있던 데이터도 같이 사라진다. 그러기 때문에 도커가 설치된 물리서버(호스트)의 디스크를 마운트해 그 디스크에 데이터를 저장한다.

- 마운트 : '디스크를 연결해 데이터를 기록할 수 있도록 한 상태'를 의미
  
그러면 컨테이너가 폐기되더라도 데이터는 컨테이너 외부에 안전하게 저장되어 사라지지 않는다.

그리고 데이터를 이렇게 외부에 저장하면 다른 컨테이너와 데이터를 공유할 수도 있어서 매우 편리하다.

## 정리

![](/assets/images/2022-12-29/docker1.png)

- - -



## 도커의 장점과 단점

### 도커의 장점

> **환경을 격리할 수 있다** 
> 
> 이로써 
>   > 1. 독립된 환경
>   >   - 여러 개의 컨테이너를 띄울 수 있고 똑같은 애플리케이션도 여러 개 띄울 수 있다. 
>   > 2. 이미지를 만들 수 있음
>   > 3. 컨테이너에 커널을 포함시키지 않아도 됨

